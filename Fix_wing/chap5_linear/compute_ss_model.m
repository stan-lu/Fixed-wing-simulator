function [A_lon,B_lon,A_lat,B_lat] = compute_ss_model(filename,x_trim,u_trim)
% x_trim is the trimmed state,x_trim是修正状态
% u_trim is the trimmed input,u_trim是修正输入
% x_trim,u_trim为待线性化simulink模块的状态和输入

% add stuff here  已加
[A,B,C,D] = linmod(filename, x_trim, u_trim);

E1 = [...
      0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;...
      0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;...
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;...
      0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0;...
      0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;...
      ];
E2 = [...
      0, 1, 0, 0;...
      0, 0, 1, 0;...
      ];
A_lat = E1 * A * E1';
B_lat = E1 * B * E2';%横向状态空间方程

E3 = [...
      0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;...
      0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;...
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;...
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;...
      0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
      ];
E4 = [...
      1, 0, 0, 0;...
      0, 0, 0, 1;...
      ];

A_lon = E3 * A * E3';
B_lon = E3 * B * E4';%纵向状态空间方程